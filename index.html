<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>My Mapbox Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    #filter-buttons {
      position: absolute;
      z-index: 1;
      background: white;
      padding: 10px;
    }
    #filter-buttons button {
      margin: 5px;
      padding: 6px 12px;
      font-size: 14px;
      border: 1px solid #ccc;
      background-color: #fff;
      cursor: pointer;
    }
    #filter-buttons button:hover {
      background-color: #eee;
    }

    #map-title {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 2;
  background: rgba(255, 255, 255, 0.9);
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 20px;
  font-weight: bold;
  border-radius: 4px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.3);
      
  </style>
</head>
<body>
<div id="map-title">Wonderful World of Wildlife Crossings</div>
<div id="map"></div>
  
<div id="filters" style="position: absolute; top: 10px; left: 10px; background: white; z-index: 2; padding: 10px;">
  <label>Status:</label>
  <select id="filter-status">
    <option value="">All</option>
    <option>Planned Structure</option>
    <option>Completed Structure</option>
    <option>Statewide Analysis</option>
  </select><br>

  <label>Detail:</label>
  <select id="filter-detail">
    <option value="">All</option>
    <option>Case Study</option>
    <option>Technical Specifications</option>
  </select><br>

  <label>Funding:</label>
  <select id="filter-funding">
    <option value="">All</option>
    <option>Wildlife Crossings Pilot Program (WCPP)</option>
    <option>Transportation Alternatives Program</option>
  </select><br>

  <label>Species:</label>
  <select id="filter-species">
    <option value="">All</option>
    <option>Large Mammals</option>
    <option>Ungulates</option>
    <option>Small Mammals</option>
    <option>Reptiles and Amphibians</option>
  </select>

  // region filter

  <label>State/Province:</label>
<select id="filter-region">
  <option value="">All</option>
  <!-- United States -->
  <option>Alabama</option>
  <option>Alaska</option>
  <option>Arizona</option>
  <option>Arkansas</option>
  <option>California</option>
  <option>Colorado</option>
  <option>Connecticut</option>
  <option>Delaware</option>
  <option>Florida</option>
  <option>Georgia</option>
  <option>Hawaii</option>
  <option>Idaho</option>
  <option>Illinois</option>
  <option>Indiana</option>
  <option>Iowa</option>
  <option>Kansas</option>
  <option>Kentucky</option>
  <option>Louisiana</option>
  <option>Maine</option>
  <option>Maryland</option>
  <option>Massachusetts</option>
  <option>Michigan</option>
  <option>Minnesota</option>
  <option>Mississippi</option>
  <option>Missouri</option>
  <option>Montana</option>
  <option>Nebraska</option>
  <option>Nevada</option>
  <option>New Hampshire</option>
  <option>New Jersey</option>
  <option>New Mexico</option>
  <option>New York</option>
  <option>North Carolina</option>
  <option>North Dakota</option>
  <option>Ohio</option>
  <option>Oklahoma</option>
  <option>Oregon</option>
  <option>Pennsylvania</option>
  <option>Rhode Island</option>
  <option>South Carolina</option>
  <option>South Dakota</option>
  <option>Tennessee</option>
  <option>Texas</option>
  <option>Utah</option>
  <option>Vermont</option>
  <option>Virginia</option>
  <option>Washington</option>
  <option>West Virginia</option>
  <option>Wisconsin</option>
  <option>Wyoming</option>

  <!-- Canada -->
  <option>Alberta</option>
  <option>British Columbia</option>
  <option>Manitoba</option>
  <option>New Brunswick</option>
  <option>Newfoundland and Labrador</option>
  <option>Nova Scotia</option>
  <option>Ontario</option>
  <option>Prince Edward Island</option>
  <option>Quebec</option>
  <option>Saskatchewan</option>
  <option>Northwest Territories</option>
  <option>Nunavut</option>
  <option>Yukon</option>
</select><br>
  
</div>

<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiYXJjc29sdXRpb25zIiwiYSI6ImNsbHBpb2E0NTAydTEzZG9hcmVmdGdvaG4ifQ.caa0jV__lbPqAoJxVAZVlA';

  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/light-v10',
    center: [-100, 45],
    zoom: 3
  });

  map.addControl(new mapboxgl.NavigationControl(), 'top-right');

  new mapboxgl.Marker()
    .setLngLat([-100, 45])
    .setPopup(new mapboxgl.Popup({ offset: 25 }).setHTML(`
      <div style="max-width: 250px;">
        <h3>Wildlife Crossing Example</h3>
        <p>This location features an overpass used by elk and deer in migration season.</p>
        <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/Wildlife_Overpass_Banff.jpg"
             alt="Wildlife Overpass"
             style="width:100%; border-radius: 6px; margin-top: 5px;" />
      </div>`))
    .addTo(map);

  const geojson = {
    type: 'FeatureCollection',
    features: [
      { type: 'Feature', properties: { title: 'Crossing A', type: 'Overpass' }, geometry: { type: 'Point', coordinates: [-79.4, 43.7] }},
      { type: 'Feature', properties: { title: 'Crossing B', type: 'Underpass' }, geometry: { type: 'Point', coordinates: [-79.3, 43.65] }},
      { type: 'Feature', properties: { title: 'Crossing C', type: 'State-wide' }, geometry: { type: 'Point', coordinates: [-79.2, 43.6] }}
    ]
  };

  
  const allMarkers = [];

  function renderMarkers(filterType = null) {
    allMarkers.forEach(m => m.remove());
    allMarkers.length = 0;

    geojson.features
      .filter(f => !filterType || f.properties.type === filterType)
      .forEach(feature => {
        const marker = new mapboxgl.Marker()
          .setLngLat(feature.geometry.coordinates)
          .setPopup(new mapboxgl.Popup().setHTML(`<h4>${feature.properties.title}</h4><p>${feature.properties.type}</p>`))
          .addTo(map);

        allMarkers.push(marker);
      });
  }
// new render 
function renderMarkers() {
  const status = document.getElementById('filter-status').value;
  const detail = document.getElementById('filter-detail').value;
  const funding = document.getElementById('filter-funding').value;
  const species = document.getElementById('filter-species').value;

  // Remove existing markers
  allMarkers.forEach(m => m.remove());
  allMarkers.length = 0;

  geojson.features
    .filter(f => {
      const matchStatus = !status || f.properties.status === status;
      const matchDetail = !detail || f.properties.detail === detail;
      const matchFunding = !funding || f.properties.funding === funding;
      const matchSpecies = !species || f.properties.species === species;
      return matchStatus && matchDetail && matchFunding && matchSpecies;
    })
    .forEach(feature => {
      const marker = new mapboxgl.Marker()
        .setLngLat(feature.geometry.coordinates)
        .setPopup(new mapboxgl.Popup().setHTML(`
          <h4>${feature.properties.title}</h4>
          <p><strong>Status:</strong> ${feature.properties.status}</p>
          <p><strong>Detail:</strong> ${feature.properties.detail}</p>
          <p><strong>Funding:</strong> ${feature.properties.funding}</p>
          <p><strong>Species:</strong> ${feature.properties.species}</p>
        `))
        .addTo(map);

      allMarkers.push(marker);
    });
}
  
  map.on('load', () => {
    renderMarkers();
    ['filter-status', 'filter-detail', 'filter-funding', 'filter-species'].forEach(id => {
  document.getElementById(id).addEventListener('change', renderMarkers);
});
  });
  
</script>

</body>
</html>
